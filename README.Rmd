---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-",
  fig.height = 3,
  fig.width = 8
)
```

# bayesRates

__bayesRates__ is an R package that allows users to (1) perform two-sample tests with binomial and Poisson data from a Bayesian perspective and (2) determine sample sizes for designing such procedures.

```{r}
library(bayesRates)
```

# Binomial tests

Suppose that we have two coins, a quarter and a half dollar, and we're interested in determining whether or not they flip heads with the same probability.  After flipping each 50 times, the quarter flips heads 26 times and the half dollar flips heads 34 times.  Should we conclude the likelihoods are the same?

One way to address the problem is with `prop.test()`:

```{r}
prop.test(x = c(26, 34), n = c(50, 50), correct = FALSE)
```

`prop.test()` uses the standard asymptotic two-sample test of proportions based on the central limit theorem using pooling:
```{r}
x <- 26; nx <- 50; px <- x/nx
y <- 34; ny <- 50; py <- y/ny
pp <- (x+y)/(nx+ny)

t <- (px-py)/sqrt(pp*(1-pp)/nx + pp*(1-pp)/ny)
2*pnorm(t) # two-sided p-value using the clt
```

`binom.test()` is similar, but uses the exact different procedure. __bayesRates__ offers another test of the same hypothesis with more of a Bayesian flavor, `bayesBinomTest()`.  In this function, the user begins by specifying probabilites ([beliefs](http://en.wikipedia.org/wiki/Bayesian_probability#Objective_and_subjective_Bayesian_probabilities)) on the null and alternative hypotheses, typically `1/2` and `1/2` from the [principle of insufficient reason](http://en.wikipedia.org/wiki/Principle_of_indifference#History_of_the_principle_of_indifference).  
```{r}
pH0 <- 1/2; pH1 <- 1/2
```

The user then specifies probability distributions on the parameters under each of the hypotheses.  Under the null hypothesis, the proportions are the same quantity, and so only a single (univariate) distribution need be specified.  Since [beta distributions](http://en.wikipedia.org/wiki/Beta_distribution) are well suited to this task, they are assumed in __bayesRates__, so the user only needs to specify the parameters of the beta distribution.  This is facilitated with the `plotBeta()` function, which takes in the two parameters and simply plots the ensuing beta distribution. Assuming the two coins flip heads at the same rate, it is reasonable to assume that that rate is around 50%, so that a Beta(10, 10) might be reasonable:
```{r}
plotBeta(10, 10)
```

Now operate under the assumption that they are different.  In that case, what are the beliefs about the two?  One way to think about this is to think about them one at a time.  If we think that they are the same, and that the quarter is fair (represented by the Beta(10,10)), then we can assume they are both like that.  If we think they are different, we may still think that the quarter is fair (Beta(10,10)), so we only need to choose the distribution of the half-dollar.  Perhaps that distribution is well-represented by a Beta(2,1) distribution.  The two distributions can be visualized together using `plotBeta()`:
```{r}
plotBeta(c(10,2),c(10,1))
```


## Installation

* From Github: `devtools::install_github("dkahle/bayesRates")`

<!-- * From CRAN: `install.packages("bayesRates")` -->

